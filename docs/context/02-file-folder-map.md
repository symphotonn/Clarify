# 02. File/Folder Map
_Last updated: 2026-02-13 06:20 UTC_

One-line purpose per folder/file. Regenerated by scripts/update_context_docs.sh.

## Folders
- Clarify/App - app lifecycle and orchestration state.
- Clarify/Context - text/context capture and cursor anchoring.
- Clarify/Hotkey - global hotkey definitions and registration.
- Clarify/LLM - prompt construction, streaming client, parser, models.
- Clarify/Panel - floating overlay panel and placement logic.
- Clarify/Storage - persisted settings and in-memory explanation history.
- Clarify/Utilities - constants and cross-cutting helpers.
- Clarify/Views - SwiftUI screens for overlay and settings.
- Clarify/Views/Components - reusable UI components.
- Clarify/Resources - entitlements and asset metadata.
- ClarifyTests - XCTest coverage for core behaviors.
- docs/context - living architecture, map, data, decisions, and status docs.
- scripts - project automation scripts for developer workflows.
- .githooks - local git hook scripts used in this repository.

## Files
- .githooks/pre-commit - Pre-commit automation that refreshes and stages context docs.
- Clarify.xcodeproj/project.pbxproj - Xcode project configuration, build settings, and file references.
- Clarify.xcodeproj/xcshareddata/xcschemes/Clarify.xcscheme - Shared Xcode scheme for build/test/run actions.
- Clarify/App/AppDelegate.swift - Wires runtime dependencies and application lifecycle callbacks.
- Clarify/App/AppState.swift - Main actor state machine for capture, streaming, overlay phases, and shortcuts.
- Clarify/App/ChatSession.swift - Ephemeral follow-up chat model for multi-turn message state and streaming deltas.
- Clarify/App/ClarifyApp.swift - App entry point; defines menu bar and settings scenes.
- Clarify/Context/AccessibilityCapture.swift - Captures selected text/context via AX, DOM hints, OCR, and clipboard fallback.
- Clarify/Context/ContextInfo.swift - Context payload model for selected text and surrounding source metadata.
- Clarify/Context/CursorPositionProvider.swift - Computes overlay anchor position from selection bounds or mouse location.
- Clarify/Hotkey/DoublePressDetector.swift - Detects consecutive hotkey presses within a time window.
- Clarify/Hotkey/HotkeyBinding.swift - Defines supported hotkey keys, modifiers, and matching logic.
- Clarify/Hotkey/HotkeyManager.swift - Registers global Carbon hotkey and emits press/double-press events.
- Clarify/Hotkey/PermissionManager.swift - Tracks and requests Accessibility/screen-capture permissions.
- Clarify/Info.plist - App metadata and macOS permission usage strings/configuration.
- Clarify/LLM/CompletionQualityGate.swift - Purpose not documented yet; add one-line description.
- Clarify/LLM/Models.swift - Shared API/prompt/stream domain models and protocols.
- Clarify/LLM/OpenAIClient.swift - OpenAI streaming client with timeout fallback and response extraction.
- Clarify/LLM/PromptBuilder.swift - Builds prompt instructions/input from context, depth, and intent heuristics.
- Clarify/LLM/SSEParser.swift - Parses SSE frames into delta/done/error stream events.
- Clarify/Panel/OverlayPanel.swift - Custom floating NSPanel configuration for the explanation overlay.
- Clarify/Panel/PanelController.swift - Shows/hides panel, installs outside-click and key monitors, handles dismissal.
- Clarify/Panel/PanelPositioner.swift - Calculates on-screen clamped panel frame near selection.
- Clarify/Resources/Assets.xcassets/AppIcon.appiconset/Contents.json - App icon asset metadata.
- Clarify/Resources/Assets.xcassets/Contents.json - Asset catalog root manifest.
- Clarify/Resources/Clarify.entitlements - App entitlements used for local debug/runtime behavior.
- Clarify/Storage/ExplanationBuffer.swift - In-memory ring buffer of recent explanations for deeper follow-ups.
- Clarify/Storage/SettingsManager.swift - Persists API/model/hotkey settings and exposes registration issues.
- Clarify/Utilities/Constants.swift - Central constants for API, UI sizing, timeouts, and budgets.
- Clarify/Utilities/Extensions.swift - Shared helpers for geometry conversion and string truncation/context slicing.
- Clarify/Views/ChatView.swift - Follow-up chat UI with message bubbles, auto-scroll, and input composer.
- Clarify/Views/Components/ShimmerView.swift - Skeleton shimmer placeholder for pre-token loading state.
- Clarify/Views/Components/StreamingTextView.swift - Renders streamed text with progressive reveal and cursor indicator.
- Clarify/Views/Components/VisualEffectBackground.swift - AppKit visual effect wrapper for translucent overlay background.
- Clarify/Views/ExplanationView.swift - Main overlay UI: loading, result, error, permission, and actions.
- Clarify/Views/OnboardingView.swift - Permission onboarding UI used when accessibility access is missing.
- Clarify/Views/SettingsView.swift - Settings UI for API key, hotkey capture/reset, and advanced model.
- ClarifyTests/AppStateTests.swift - Tests AppState request lifecycle, phases, metrics, and keyboard actions.
- ClarifyTests/ChatSessionTests.swift - Tests chat session seeding, message append, and API message mapping.
- ClarifyTests/CompletionQualityGateTests.swift - Purpose not documented yet; add one-line description.
- ClarifyTests/DoublePressDetectorTests.swift - Tests double-press timing detection boundaries.
- ClarifyTests/ExplanationBufferTests.swift - Tests explanation buffer capacity and eviction behavior.
- ClarifyTests/HotkeyManagerTests.swift - Tests hotkey matching, modifiers, and detector integration points.
- ClarifyTests/PanelPositionerTests.swift - Tests panel placement and edge clamping logic.
- ClarifyTests/PromptBuilderTests.swift - Tests prompt constraints, depth behavior, and inference rules.
- ClarifyTests/SSEParserTests.swift - Tests SSE framing, deltas, done, and error parsing behavior.
- docs/context/01-system-overview.md - One-page architecture and request-flow reorientation document.
- docs/context/02-file-folder-map.md - Generated one-line map of folders/files and responsibilities.
- docs/context/03-data-model.md - Persistent/runtime/external data shapes and relationships.
- docs/context/04-decision-log.md - Append-only record of architecture and product decisions.
- docs/context/05-current-state.md - Living snapshot of what works, gaps, and next steps.
- docs/context/06-smoke-test-checklist.md - Automated and manual smoke-test checklist with latest execution log.
- docs/context/README.md - How to maintain and auto-refresh the context documentation pack.
- run.sh - Builds Debug app, rsyncs to ~/Applications/Clarify.app, and launches it.
- scripts/update_context_docs.sh - Regenerates context docs and updates timestamps.
